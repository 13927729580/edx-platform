<%page expression_filter="h"/>
<%inherit file="../main.html" />
<%namespace name='static' file='static_content.html'/>
<%!
from datetime import datetime
from django.utils.translation import ugettext as _
from django.core.urlresolvers import reverse

from openedx.core.djangolib.markup import HTML, Text
%>

<%namespace name='static' file='../static_content.html'/>

<%static:css group='style-main-v2'/>

<%block name="js_extra">
<script type="text/javascript" src="${static.url('js/vendor/slick.min.js')}"></script>
<script type="text/javascript">

    $(document).ready(function () {
        $(".course-slider-xs").html();
        addSlider();
    });

    $(window).resize(function () {
        addSlider();
    });

    //custom function showing current slide
    var $status = $('.pagingInfo');
    var $slickElement = $('.course-slider-xs');

    $slickElement.on('init reInit afterChange', function (event, slick, currentSlide, nextSlide) {
        //currentSlide is undefined on init -- set it to 0 in this case (currentSlide is 0 based)
        var i = (currentSlide ? currentSlide : 0) + 1;
        $status.text(i + ' of ' + slick.slideCount);
    });

    function addSlider() {
        var isMobileResolution = $(window).width() <= 767,
                sliderExists = $('.course-slider-xs').hasClass("slick-slider");
        $(".course-card").toggleClass("slidable", isMobileResolution);
        if (isMobileResolution) {    //Second condition will avoid the multiple calls from resize
            if (!sliderExists) {
                $(".course-slider-xs").slick({
                    arrows: false,
                    centerMode: true,
                    centerPadding: '40px',
                    slidesToShow: 1
                });
            }
        } else {
            $(".course-slider-xs").html();
        }
    }

    $("ul.faq-links-list li.item").click(function(){
        if ($(this).find(".answer").hasClass('hidden')) {
            $(this).find(".answer").removeClass("hidden");
        } else {
            $(this).find(".answer").addClass("hidden");
        }
    });

</script>

<script type="text/javascript">
    $(function () {
        $("#accordion-group").accordion({
            header: "> .accordion-item > .accordion-head",
            collapsible: true,
            heightStyle: "content"
        });
    });
</script>
</%block>

<div id="program-details-page">

        <div class="main-banner">
            <div class="grid-manual">
                <div class="row">
                    <div class="col col-12 md-col-8 lg-col-9">
                        <div class="org-logo">
                            <img src="https://www.edx.org/sites/default/files/school/image/logo/iimb-200x101.png" alt="Indian Institute of Management, Bangalore Logo">
                        </div>
                        <h1 class="banner-title">${program['title']}</h1>
                        <p class="banner-description">${program['subtitle']}</p>
                        <button type="button" class="btn-brand hidden-sm">Start the ${program['type']['name']} Program</button>
                    </div>
                    <div class="col col-12 md-col-4 lg-col-3" id="course-trailer">
                        <a href="#!" class="trailer-link visible-sm">
                            <i class="fa fa-play-circle-o" aria-hidden="true"></i>
                            <span>View Course Trailer</span>
                        </a>
                        <div class="hidden-sm">
                            <a href="#!" class="btn-play">
                                <img src="${static.url('images/programs/btn-play.png')}" alt="Play"/>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid-manual data-table">
            <div class="row">
                <div class="col col-12 md-col-7 lg-col-8 left-col">
                    <ul class="list-divided program-desc-tbl">
                        <li class="item">
                            <span>
                                <span class="fa fa-book fa-lg" aria-hidden="true"></span>
                                Number of Courses
                            </span>
                            <a href="#courses">${len(program['courses'])} courses in program</a>
                        </li>
                        <li class="item">
                            <span>
                                <span class="fa fa-clock-o fa-lg" aria-hidden="true"></span>
                                Average Length
                            </span>
                            <span>${program['weeks_to_complete']} weeks per course</span>
                        </li>
                        <li class="item">
                            <span>
                                <span class="fa fa-tachometer fa-lg" aria-hidden="true"></span>
                                Effort
                            </span>
                            <span>${program['min_hours_effort_per_week']}-${program['max_hours_effort_per_week']} hours per week, per course</span>
                        </li>
                        <li class="item">
                            <span>
                                <span class="fa fa-tag fa-lg" aria-hidden="true"></span>
                                Price (USD)
                            </span>
                            <span>$300 per course, <br class="visible-sm"/> $1200 for entire program</span>
                        </li>
                    </ul>
                    <div id="accordion-group">
                        <div class="accordion-item">
                            <div class="accordion-head">Overview</div>
                            <div class="accordion-content">
                                <p>
                                    ${program['overview']}
                                </p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-head">Job Outlook</div>
                            <div class="accordion-content">

                                <ul class="list-bulleted list-disc no-indent">
                                    % for item in program['job_outlook_items']:
                                        <li>${item}</li>
                                    % endfor
                                </ul>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-head">What You'll Learn</div>
                            <div class="accordion-content">
                                <ul class="list-bulleted list-disc no-indent">
                                    % for item in program['expected_learning_items']:
                                        <li>${item}</li>
                                    % endfor
                                </ul>
                            </div>
                        </div>
                        <div class="accordion-item instructors-mobile-list">
                            <div class="accordion-head">Instructors</div>
                            <div class="accordion-content">
                                <div class="instructor-profiles">
                                    %for instructor in program['staff']:
                                        <div class="profile-item">
                                            <div class="avatar">
                                                <div class="img-holder">
                                                    <img src="${static.url(instructor['profile_image_url'])}" alt="${instructor['given_name']}"/>
                                                </div>
                                            </div>
                                            <div class="details">
                                                <div class="name">${instructor['given_name']}</div>
                                                <div class="dept">${instructor['position']['organization_name']}</div>
                                            </div>
                                        </div>
                                    %endfor
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-head">${program['type']['faq']['question']}</div>
                            <div class="accordion-content">
                                <p>${program['type']['faq']['answer']}</p>
                                <div class="vertical-icon-list">
                                    <div class="list-item">
                                        <div class="icon-container">
                                            <img src="${static.url('images/programs/img-1.png')}"/>
                                        </div>
                                        <small>Choose Your Program</small>
                                    </div>
                                    <div class="list-item">
                                        <div class="icon-container">
                                            <img src="${static.url('images/programs/img-2.png')}"/>
                                        </div>
                                        <small>Learn Great Things at Your Own Place</small>
                                    </div>
                                    <div class="list-item">
                                        <div class="icon-container">
                                            <img src="${static.url('images/programs/img-3.png')}"/>
                                        </div>
                                        <small>Earn a valuable Credntial</small>
                                    </div>
                                    <div class="list-item">
                                        <div class="icon-container">
                                            <img src="${static.url('images/programs/img-4.png')}"/>
                                        </div>
                                        <small>Advance Your Career</small>
                                    </div>
                                    <div class="list-item">
                                        <div class="icon-container">
                                            <img src="${static.url('images/programs/img-5.png')}"/>
                                        </div>
                                        <small>Or Purchase a Full Master's Degree</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-head">FAQ</div>
                            <div class="accordion-content">
                                <ul class="list-unstyled faq-links-list">
                                    %for item in program['faq']:
                                        <li class="item">
                                            <a href="#!">${item['question']}</a>
                                            <div class="answer hidden">${item['answer']}</div>
                                        </li>
                                    %endfor
                                </ul>
                            </div>
                        </div>
                    </div>
                    <blockquote class="program-quote visible-sm">
                        <div class="quote">
                            <span class="pull-right hidden-sm">
                                <img src="${static.url('images/programs/quote-logo.png')}" width="90" height="90"/>
                            </span>
                            <span>
                                ${program['individual_endorsements'][0]['quote']}
                            </span>
                            <img class="visible-sm pull-left" src="${static.url('images/programs/quote-logo.png')}" width="40" height="40"/>
                            <span class="writer">
                                ${program['individual_endorsements'][0]['endorser']['given_name']},
                                ${program['individual_endorsements'][0]['endorser']['position']['title']}
                            </span>
                        </div>
                    </blockquote>
                </div>

                <div class="col col-12 md-col-5 lg-col-4 right-col hidden-sm">

                    <h2 class="instructors-title">Meet the Instructors <span>(${len(program['staff'])})</span></h2>
                    <div class="instructor-profiles">
                        %for instructor in program['staff']:
                            <div class="profile-item">
                                <div class="avatar">
                                    <div class="img-holder">
                                        <img src="${static.url(instructor['profile_image_url'])}" alt="${instructor['given_name']}"/>
                                    </div>
                                </div>
                                <div class="details">
                                    <div class="name">${instructor['given_name']}</div>
                                    <div class="dept">${instructor['position']['organization_name']}</div>
                                </div>
                            </div>
                        %endfor

                        <div class="pagination hidden-xs">
                            <div class="pages">1-4 of 8</div>
                            <div class="controls">
                                <a href="#" class="active"><span class="fa fa-chevron-down active"></span></a>
                                <a href="#"><span class="fa fa-chevron-up"></span></a>
                            </div>
                        </div>
                    </div>
                    <blockquote class="program-quote">
                        <div class="quote">
                            <span class="pull-right hidden-sm">
                                <img src="${static.url('images/programs/quote-logo.png')}" width="90" height="90"/>
                            </span>
                            <span>
                               ${program['individual_endorsements'][0]['quote']}
                            </span>
                            <img class="visible-sm pull-left" src="${static.url('images/programs/quote-logo.png')}" width="40" height="40"/>
                            <span class="writer">
                                ${program['individual_endorsements'][0]['endorser']['given_name']},
                                ${program['individual_endorsements'][0]['endorser']['position']['title']}
                            </span>
                        </div>
                    </blockquote>
                </div>
            </div>
        </div>

        <div class="container courses-in-program" id="courses">
            <h3 class="hd">Courses in the ${program['type']['name']}</h3>
            <div class="course-slider-xs">
                %for course in program['courses']:
                    <div class="course-card">
                        <div class="tbl-view">
                            <div class="tbl-col col-full-sm">
                                <h4 class="hd title">
                                    ${course['title']}
                                    <small>
                                        <span>
                                            <i class="fa fa-clock-o" aria-hidden="true"></i>
                                            Starts ${datetime.strptime(course['course_runs'][0]['start'], '%Y-%m-%dT%H:%M:%SZ').strftime('%B %-d, %Y')}
                                        </span>

                                        %if course['course_runs'][0]['pacing_type'] == "instructor_paced":
                                            <span>Instructor - Paced</span>
                                        %else:
                                            <span>Self - Paced</span>
                                        %endif
                                    </small>

                                </h4>
                                <p class="copy-meta">
                                   ${course['course_runs'][0]['short_description']}
                                </p>
                            </div>
                            <div class="tbl-col col-full-sm">
                                <button type="button" class="btn-brand btn-enroll-now">Enroll Now</button>
                            </div>
                        </div>
                    </div>
                %endfor

            </div>
            <span class="pagingInfo"></span>
        </div>

    </div> <!-- Program Details Page end -->



